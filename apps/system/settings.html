<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Untitled Document</title>
<script>eval(top.frames['idesktop'].setAppProperties());</script>
<style>
#apps {
	position:relative;
	display:inline;
	width:25%;
	overflow:scroll;
	height: 100%;
}

#keys {
	position:relative;
	display:inline;
	width:75%;
	overflow:scroll;
}
</style>
<script>
var strSettings = new Array;
var strAppsList = new Array;

function unload(){
	if(confirm("Are you sure you wish to quit?")) parent.killApp();
}

function getSettingList() {
	if (parent!==self){
		var notPSP = (navigator.userAgent.indexOf('PlayStation Portable') != -1) ? false : true;
		if (notPSP){
			var cookiedata = unescape(parent.window.document.cookie);
			var cookiecontents = cookiedata.split("=");
			if(cookiecontents[0] == "cookiedata") {
				strSettings = cookiecontents[1].split("»");
			}else strSettings = "";
		}else
			strSettings = window.top.isettings.document.getElementById("settingList").value.split("»");	// Split up the settings
	} else alert("Program not functional in this mode.");
}

function makeAppList(){
	for (var i = 0 ; i < strSettings.length ; i++ ) {
		var strSettingParts = strSettings[i].split("¿");			// Split key from value
		var strSettingExist = false;
		for (var i2 = 0 ; i2 < strAppsList.length ; i2++){
			if ( strAppsList[i2] == strSettingParts[0]){
				strSettingExist=true;
				break;
			}
		}
		
		if (!strSettingExist){
			strAppsList[strAppsList.length] = strSettingParts[0];
			frames['apps'].document.write("<a href='javascript:;' onclick='parent.makeKeyList(\""+strSettingParts[0]+"\")'>"+strSettingParts[0]+"</a><br>");
		}
	}
}


function makeKeyList(strApp){
	frames['keys'].document.open();
	// The following code is crap, but required. It is very bad practice, as it uses up resources to gain time.
	// This code is very bad practive, and should rarely be used, if ever.
	
	// BEGIN CRAP CODE
	for(var i = 0; i<90;i++) {	
		frames['keys'].document.write("<script>var a = 300*2;</"+"script>");
	}
	// END CRAP CODE
	
	frames['keys'].document.write("<head><script>eval(top.frames['idesktop'].setAppProperties());<"+"/script></head>");

	// BEGIN CRAP CODE
	for(var i = 0; i<50;i++) {	
		frames['keys'].document.write("<script>var a = 300*2;</"+"script>");
	}
	// END CRAP CODE
	
	frames['keys'].document.write("<body><table border='0' width='100%' cellspacing='0'><tr><th class='listHead'>Name</th><th class='listHead'>Type</th><th class='listHead'>Data</th></th><th class='listHead'>&nbsp;</tr>");
	for (var i = 0 ; i < strSettings.length ; i++ ) {
		var strSettingParts = strSettings[i].split("¿");			// Split key from value
		if (strSettingParts[0]==strApp){
			var strParts = strSettingParts[1].split("º");			
			frames['keys'].document.write("<tr><td>"+strParts[0]+"</td>");
			frames['keys'].document.write("<td>"+typeof(parent.correctVarType(strParts[1]))+"</td>");
			frames['keys'].document.write("<td width='60'><script>drawInput('"+(( strParts[0].charAt(0)=="«" ) ? "password" : "text" )+"','"+strParts[0]+"','"+strParts[1]+"','','','width:60px;');</"+"script></td><td width='30'><input value='Save' type='button' onclick='parent.parent.saveSetting(\""+strApp+"\",\""+strParts[0]+"\",document.getElementById(\""+strParts[0]+"\").text);parent.parent.storeSettings();' /></td></tr>");
		}
	}
	frames['keys'].document.write("</table></body>");
	frames['keys'].document.close();
}

getSettingList();
</script>
</head>

<body>
<table height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
  <td colspan="3" height="20" style="font-size:12px;"><a href="javascript:;" onclick="parent.clearSettings();">Clear all settings</a></td>
  </tr>
<tr><td width="110">
<iframe id="apps" style="width:100%;" src="../../system/blank.htm" name="apps"></iframe>
</td>
<td width="2">&nbsp;</td>
<td>
<iframe id="keys" style="width:100%;" src="../../system/blank.htm" name="keys"></iframe></td>
</tr></table>
<script language="javascript" type="text/javascript">
var intEffectiveHeight = document.body.clientHeight-22;

document.getElementById('apps').style.height=intEffectiveHeight;
document.getElementById('keys').style.height=intEffectiveHeight;


function writeSettings(){
	frames['apps'].document.open();
	frames['apps'].document.write("<style>body{margin:0px;}</style>");
	makeAppList();
	frames['apps'].document.close();
	
	frames['keys'].document.open();
	makeKeyList('main');
	frames['keys'].document.close();
}

setTimeout("writeSettings();",2500);
</script>
</body>
</html>
